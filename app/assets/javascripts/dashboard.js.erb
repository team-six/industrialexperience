//Menu Drop Down
$(".top-level").click(function(){	
	$(this).next(".second-level").slideToggle("fast");
});



//Import CSV Toggle
$(".import-button").click(function(){
	$("div.csv-import").slideToggle();
});

//Hide Flash alert after 3 seconds
setTimeout(function(){
  $(".flash").fadeOut("slow");
},3000);


//Find active link, open parent
$(".current").parent().prev(".top-level").click();

//$(".active-section").show();

//Live Clock

function updateClock(){
	var currentTime = new Date ( );
  var currentHours = currentTime.getHours ( );
  var currentMinutes = currentTime.getMinutes ( );
  var currentSeconds = currentTime.getSeconds ( );

  // Pad the minutes and seconds with leading zeros, if required
  currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
  currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;

  // Choose either "AM" or "PM" as appropriate
  var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";

  // Convert the hours component to 12-hour format if needed
  //currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;

  // Convert an hours component of "0" to "12"
  //currentHours = ( currentHours == 0 ) ? 12 : currentHours;

  // Compose the string for display
  var currentTimeString = currentHours + ":" + currentMinutes ;
   
   
  $("#clock").text(currentTimeString);       
}


 setInterval('updateClock()', 0);

 $("body").nanoScroller();




//=======================================
// Graphs
//=======================================

(function(){
var t;
function size(animate){
  if (animate == undefined){
    animate = false;
  }
  clearTimeout(t);
  t = setTimeout(function(){
    $("canvas").each(function(i,el){
      $(el).attr({
        "width":$(el).parent().width(),
        "height":$(el).parent().outerHeight()
      });
    });
    redraw(animate);
    var m = 0;
    $(".widget").height("");
    $(".widget").each(function(i,el){ m = Math.max(m,$(el).height()); });
    $(".widget").height(m);
  }, 30);
}
$(window).on('resize', function(){ size(false); });


function redraw(animation){
  var options = {};
  if (!animation){
    options.animation = false;
  } else {
    options.animation = true;
  }
  //var randomScalingFactor = function(){ return Math.round(Math.random()*1000)};
  var data = {
    labels : ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],
    datasets : [
      {
        fillColor : "rgba(99,123,133,0.4)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : []
      },
      {
        fillColor : "rgba(99,123,133,0.4)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : []
      }
    ]
  }
  var canvas = document.getElementById("chart-bookings-per-mon");
  var ctx = canvas.getContext("2d");
  new Chart(ctx).Line(data, {
    responsive: true,
    animation: false,
    scaleFontColor: "#373737"
  });
}
size(true);

}());

